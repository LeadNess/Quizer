{% extends "main/lecturerWrapper.html" %}

{% block content %}

{% load static %}
{% load main_extras %}

<link rel="stylesheet" href="{% static 'main/css/modal-window.css' %}">

<div class='jumbotron'>
    <h2>Учебные предметы</h2><br>
    <p>Здесь отображаются учебные предметы, добавленные в систему.</p>
    <div class="btn-group mr-2">
        <button class="btn btn-success js-open-modal" data-modal="add-modal" onclick='clearForms()'><img src='{% add_icon %}'> Добавить предмет</button>
    </div>
    <div class="btn-group mr-2">
        <button class="btn btn-success js-open-modal" data-modal="load-modal" onclick='clearForms()'><img src='{% download_icon %}'> Загрузить предмет</button>
    </div>
    {% for subject, tests_count in subjects %}
    <hr class="my-4">
    <h3>{{ subject.name }}</h3>
    <p>{{ subject.description }}</p>
    <p><img src='{% database_icon %}'> Тестов к предмету: {{ tests_count }}<br>
    <div class="btn-group mr-2">
        <button class="btn btn-primary js-open-modal" data-modal="edit-modal" onclick='fillEditModal("{{ subject.id }}", "{{ subject.name }}", "{{ subject.description }}")'><img src="{% edit_icon %}"> Редактировать</button>
    </div>
    <div class="btn-group mr-2">
        <button class="btn btn-danger js-open-modal" data-modal="delete-modal" onclick='fillDeleteModal("{{ subject.id }}", "{{ subject.name }}")'><img src="{% delete_icon %}"> Удалить</button>
    </div>
    {% endfor %}
</div>

<div class="modal-window" data-modal="add-modal">
   <img class="modal__cross js-modal-close" src="{% close_icon %}">
   <h4>Новый предмет</h4>
   <hr class="my hr4">
   <form action="{% url 'main:subjects' %}" method="post">
        <div>
            {% csrf_token %} 
            <div class="form-row">
              <div class="col-md-4 mb-3">
                  <label for="{{ form.name.id_for_label }}">Название предмета<br>
                    {{ form.name }}
                  </label>
              </div>
            </div>
            <div class="form-row">
               <div class="col-md-4 mb-3">
                <label for="{{ form.description.id_for_label }}">Описание<br>
                  {{ form.description }}
                </label>
              </div>
            </div>
        </div>
       <div class="modal-footer">
          <div class="btn btn-primary js-modal-close"><img src="{% cancel_icon %}"> Закрыть</div>
          <button class="btn btn-success" name="add"><img src='{% add_icon %}'> Добавить</button>
       </div>
    </form>
</div>

<div class="modal-window" data-modal="load-modal">
   <img class="modal__cross js-modal-close" src="{% close_icon %}">
   <h4>Загрузить предмет</h4>
   <hr class="my hr4">
   <form action="{% url 'main:subjects' %}" enctype="multipart/form-data" method="post">
   {% csrf_token %}
      <div>
       <div>Выберите папку с тестами к предмету:
            <input type="file" id="FileUpload" name='tests' onchange="selectFolder(event)" webkitdirectory mozdirectory msdirectory odirectory directory multiple />
            <input type="hidden" id="filesNames" value="">
       </div>
        <hr>
          <div>
            {% csrf_token %} 
            <div class="form-row">
              <div class="col-md-4 mb-3">
                  <label for="{{ form.name.id_for_label }}" id='load-subject-name'>Название предмета<br>
                    {{ form.name }}
                  </label>
              </div>
            </div>
            <div class="form-row">
               <div class="col-md-4 mb-3">
                <label for="{{ form.description.id_for_label }}">Описание<br>
                  {{ form.description }}
                </label>
              </div>
            </div>
        </div>
      </div>
     <div class="modal-footer">
        <div class="btn btn-primary js-modal-close"><img src="{% cancel_icon %}"> Закрыть</div>
        <button class="btn btn-success" name="load"><img src='{% download_icon %}'> Загрузить</button>
     </div>
   </form>
</div>

<div class="modal-window" data-modal="delete-modal">
   <img class="modal__cross js-modal-close" src="{% close_icon %}">
   <h4>Удалить предмет</h4>
   <hr class="my hr4">
   <form action="{% url 'main:subjects' %}" method="post">
   {% csrf_token %}
    <p id='delete-p'></p>
    <input type="hidden" name="subject_id" id='delete-subject-id' value="">
     <div class="modal-footer">
        <div class="btn btn-primary js-modal-close"><img src='{% cancel_icon %}'> Закрыть</div>
        <button class="btn btn-danger" name="delete"><img src='{% delete_icon %}'> Удалить</button>
     </div>
   </form>
</div>

<div class="modal-window" data-modal="edit-modal">
   <img class="modal__cross js-modal-close" src="{% close_icon %}">
   <h4>Редактировать предмет</h4>
   <hr class="my hr4">
   <form action="{% url 'main:subjects' %}" method="post">
   {% csrf_token %}
    <input type="hidden" name="subject_id" id="edit-subject-id" value="">
      <div class="form-row">
        <div class="col-md-4 mb-3">
            <label for="name">Название предмета
                <input type="text" class="form-control" id="edit-name" name="name" value="" required>
            </label>
        </div>
      </div>
      <div class="form-row">
         <div class="col-md-4 mb-3">
          <label for="description">Описание</label>
          <textarea class="form-control" rows="3" cols="30" id="edit-description" name="description">{{ subject.description }}</textarea>
        </div>
      </div>
     <div class="modal-footer">
        <div class="btn btn-primary js-modal-close"><img src='{% cancel_icon %}'> Закрыть</div>
        <button class="btn btn-primary" name="edit"><img src='{% edit_icon %}'> Изменить</button>
     </div>
   </form>
</div>

{% if modal_title %}
    <div class="modal-window active" data-modal="info-modal">
       <img class="modal__cross js-modal-close" src="{% close_icon %}">
       <h4>{{ modal_title }}</h4>
       <hr class="my hr4">
       <p>{{ modal_message }}</p>
       <div class="modal-footer">
          <button class="btn btn-primary js-modal-close"><img src='{% cancel_icon %}'> Закрыть</button>
       </div>
    </div>
    <div class="overlay js-overlay-modal active"></div>
{% else %}
    <div class="overlay js-overlay-modal"></div>
{% endif %}

<script src="{% static 'main/js/modalWindow.js' %}"></script>
<script src="{% static 'main/js/managingSubjects.js' %}"></script>
<script type="text/javascript">
  
</script>

{% endblock %}